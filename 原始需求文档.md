# HasteCLI 项目需求清单 (增强版：含图形界面与处理策略)

## 项目名称：HasteGUI (或 HasteCLI with GUI)

**名称释义：** 在原有"Haste"品牌基础上，明确表明其图形界面特性，同时保持与命令行版本的一致性。

---

## 一、核心架构

### 1. 双模式设计
- **GUI 模式**：提供完整的图形界面体验
- **CLI 模式**：保留原有命令行功能，供高级用户和自动化脚本使用
- **共享核心引擎**：GUI 和 CLI 使用相同的扫描和处理核心，确保行为一致性

### 2. 技术栈选择
- **后端**：Go (使用原有扫描引擎)
- **前端**：以下任一方案：
  - **方案A**：Go 原生 GUI 框架 (Fyne 或 GIU) - 单一二进制分发，体验一致

---

## 二、图形界面功能需求

### 1. 扫描配置界面
- **路径管理**：
  - 直观的目录树浏览器，支持多选
  - 拖拽添加目录/文件功能
  - 排除列表编辑器（支持通配符模式）
- **模式选择**：
  - 四种模式卡片式选择（基本、视频、文本、图片）
  - 每种模式有独立的配置面板（展开/收起）
  - 模式说明提示（悬停显示）
- **高级选项**：
  - 并发度调节滑块
  - 哈希算法选择下拉菜单
  - 相似度阈值调节（针对媒体模式）
  - 文件大小过滤器（最小/最大文件大小）
- **预设管理**：
  - 保存/加载常用配置预设
  - 一键应用推荐配置（如"快速扫描"、"深度扫描"）

### 2. 扫描监控界面
- **实时进度展示**：
  - 总体进度条与阶段进度条
  - 实时统计信息（已扫描文件数、发现重复组数、预计剩余时间）
  - 速度指标（文件/秒，MB/秒）
- **资源监控**：
  - CPU/内存/磁盘I使用情况图表
- **实时结果预览**：
  - 滚动显示最新发现的重复组
  - 可最小化到系统托盘继续扫描

### 3. 结果展示界面
- **分组视图**：
  - 按重复组列表显示，显示每组大小和文件数
  - 可展开组查看详细文件列表
- **文件详情**：
  - 缩略图预览（图片/视频）
  - 文本预览（文本文件）
  - 元数据展示（大小、路径、修改时间、哈希值等）
- **多维度排序**：
  - 按大小、数量、路径、时间等排序
- **智能筛选**：
  - 按文件类型筛选
  - 按路径筛选
  - 按时间范围筛选

### 4. 处理策略配置界面
- **策略选择器**：
  - 预置策略模板（"安全删除"、"移动到大容量"、"归档旧文件"等）
  - 自定义策略创建器
- **策略条件系统**：
  - 基于多条件的规则引擎：
    - 文件属性（路径、大小、时间）
    - 重复组特性（重复数量、总大小）
    - 自定义逻辑（如"保留最新"、"保留最短路径"、“保留最旧”）
- **操作配置**：
  - **删除选项**：
    - 直接删除 / 移至回收站 / 安全删除（多次覆写）
    - 删除前确认提示（可配置）
  - **移动/复制选项**：
    - 目标路径选择
    - 保持目录结构选项
    - 冲突解决策略（重命名/跳过/覆盖）
  - **标记/重命名选项**：
    - 添加前缀/后缀（如"_duplicate"）
    - 使用规则重命名

### 5. 处理执行界面
- **预览模式**：
  - 模拟执行策略，显示将执行的操作
  - 差异对比视图（处理前后对比）
- **批处理控制**：
  - 暂停/继续/停止处理
  - 跳过当前项或组
- **实时反馈**：
  - 成功/失败/跳过的操作计数
  - 详细操作日志
  - 已节省空间统计
- **撤销系统**：
  - 操作历史记录
  - 有限撤销能力（依赖操作类型）
  - 导出操作报告（用于手动恢复）

### 6. 系统与设置界面
- **全局设置**：
  - 主题选择（明/暗主题）
  - 语言本地化
  - 默认扫描路径历史
- **性能配置**：
  - I/O优先级设置
  - 缓存配置（大小、位置）
  - 硬件加速选项（GPU解码等）
- **通知配置**：
  - 扫描完成通知
  - 关键操作确认
  - 系统托盘提示

---

## 三、处理策略示例

### 1. 智能保留策略
- "保留每个重复组中最新修改的文件"
- "保留每个重复组中最高分辨率的图片/视频"
- "保留每个重复组中最短路径的文件"

### 2. 空间回收策略
- "删除所有重复项，只保留一个副本"
- "将重复文件移动到指定归档目录"
- "压缩重复组中较旧的文件"

### 3. 整理策略
- "为重複文件添加 '.dup' 后缀"
- "将重复文件移动到『重复文件』文件夹并保持结构"

### 4. 自定义脚本策略
- 支持调用外部脚本处理重复文件
- 提供API将文件信息传递给脚本
- 解析脚本执行结果

---

## 四、非功能性需求

### 1. 性能
- GUI响应性：界面操作无卡顿，即使在进行扫描时
- 内存效率：大数据集下保持合理内存占用
- 加载速度：快速加载扫描结果和预览

### 2. 用户体验
- 直观的界面设计，减少学习曲线
- 合理的默认值，开箱即用
- 清晰的反馈和状态指示
- 全面的帮助系统和工作流程引导

### 3. 可靠性
- 操作安全防护：防止误删重要文件
- 异常处理：优雅处理权限问题、文件锁定等情况
- 数据完整性：确保处理前后数据一致性

### 4. 可访问性
- 键盘导航支持
- 高对比度模式
- 屏幕阅读器兼容性

---

## 五、开发与交付物

### 1. 分发方案
- 支持Windows
- 运行程序exe

### 3. 文档
- README用户手册

---

这个增强版的需求清单将HasteCLI从一个命令行工具提升为一个完整的重复文件管理解决方案，通过图形界面降低了使用门槛，同时通过强大的处理策略满足了高级用户的需求。图形界面不仅提供了配置扫描的便利方式，更重要的是提供了可视化结果展示和灵活的处理策略配置能力，使普通用户也能安全高效地管理重复文件。